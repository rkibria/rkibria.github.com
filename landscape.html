<!doctype html>
<html>

<head>
<meta charset="utf-8">
<title></title>
<link rel="stylesheet" href="css/landscape.css">
</head>

<body>

<div id="ThreeJS" style="position: absolute; left:0px; top:0px"></div>

<script src="js/three.min.js"></script>
<script src="js/FirstPersonControls.js"></script>
<script src="js/Detector.js"></script>
<script src="js/stats.min.js"></script>
<script src="js/seedrandom.min.js"></script>
<script src="js/dat.gui.min.js"></script>
<script src="js/threex.windowresize.js"></script>
<script src="js/DynamicTerrain.js"></script>

<script>
//-------------------------------------
// CONSTS
var SCREEN_WIDTH = window.innerWidth, SCREEN_HEIGHT = window.innerHeight;

var TERRAIN_SIZE = 10;

var TERRAIN_SEGMENTS = 4;
var TERRAIN_TRACKS = TERRAIN_SEGMENTS + 1;

var MIN_TILE_CREATE_RANGE = 15;

var MOVE_SPEED = 1.0;
var TURN_SPEED = 0.1;

//-------------------------------------
// SCENE
var scene = new THREE.Scene();

// CAMERA
var VIEW_ANGLE = 45, ASPECT = SCREEN_WIDTH / SCREEN_HEIGHT, NEAR = 0.1, FAR = 20000;
var camera = new THREE.PerspectiveCamera( VIEW_ANGLE, ASPECT, NEAR, FAR);
camera.position.x = 0;
camera.position.y = 10;
camera.position.z = 0;

// RENDERER + FOG
var FogColor = 0xffffff;
scene.fog = new THREE.FogExp2( FogColor, 0.01 );

if ( Detector.webgl )
	renderer = new THREE.WebGLRenderer( {antialias:true} );
else
	renderer = new THREE.CanvasRenderer();
renderer.setSize(SCREEN_WIDTH, SCREEN_HEIGHT);
renderer.setClearColor( FogColor );
var container = document.getElementById( 'ThreeJS' );
container.appendChild( renderer.domElement );

// EVENTS
THREEx.WindowResize(renderer, camera);

// STATS
stats = new Stats();
stats.domElement.style.position = 'absolute';
stats.domElement.style.bottom = '0px';
stats.domElement.style.zIndex = 100;
container.appendChild( stats.domElement );

// CONTROLS
var controls = new THREE.FirstPersonControls( camera );
controls.movementSpeed = 10;
controls.lookSpeed = 0.1;

// LIGHT
var light = new THREE.PointLight(0xffffff, 1, 0);
light.position.set( 0, 100, 0 );
scene.add( light );

var light2 = new THREE.AmbientLight(0x333333);
scene.add(light2);

// SKYBOX
scene.background = new THREE.CubeTextureLoader()
.setPath( 'images/' )
.load( [
"sky-px.jpg",
"sky-nx.jpg",
"sky-py.jpg",
"sky-ny.jpg",
"sky-pz.jpg",
"sky-nz.jpg"
] );

//-------------------------------------
var dynTerrain = new DynamicTerrain(scene, camera);

//-------------------------------------
// GUI

var gui = new dat.GUI();
this.displayOutline = false;

var GuiParameters =
{
	showWireframe: false
};

var showWireframe = gui.add( GuiParameters, 'showWireframe' );
showWireframe.onChange(function(value) {
	dynTerrain.TriggerTerrainReset = true;
});

gui.open();

dynTerrain.init();

var clock = new THREE.Clock();

var render = function () {
	requestAnimationFrame( render );
	stats.update();

	dynTerrain.updateTerrain();

	controls.update( clock.getDelta() );
	renderer.render(scene, camera);
};

render();

</script>

</body>

</html>
